![how-does-dns-work](https://user-images.githubusercontent.com/46440898/228794027-d17ddb3c-9286-461c-9826-84897b97db99.png)

이미지 출처 : [https://www.hostinger.com/tutorials/what-is-dns](https://www.hostinger.com/tutorials/what-is-dns)

### DNS란 무엇인가?

`DNS` 는 `Domain Name System` 의 약자로, 인터넷에서 도메인 이름을 `IP` 주소로 변환하는 시스템이다.

이제 동작원리를 알기 전에 잘 모르고 넘어 갈 수 있는 `URI` 와 `URL` 의 개념에 대해서 이해를 해보자.

### URI (Uniform Resource Identifier)

`URI` 는 특정 리소스를 식별하는 통합 자원 식별자를 의미한다.

인터넷상의 리소스 **자원 자체를 식별하는 고유한 문자열 시퀀스인 것이다.**

### URL (Uniform Resource Locator)

`URL` 은 네트워크 상에서 리소스가 어디 있는지 알려주기 위한 규약이다.

흔히 우리가 알고있는 웹 주소라고도 한다.

`Muji` 는 고양이 이름이며 식별자이다. 이는 `URI` 와 비슷하지만 위치에 대한 정보가 없기 때문에 `URL` 은 될 수 없다.

**`대전광역시 서구 둔산로 100` 는 특정 위치를 가리키므로 주소**다.

`URL` 및 `URI` 와 비슷하며 간접적으로 장소를 식별한다.

### 웹 사이트 로딩에 관여하는 DNS

컴퓨터가 호스트 파일이나 캐시에서 일치하는 `IP` 주소를 찾을 수 없는 경우 `DNS` 쿼리 또는 요청을 4개의 `DNS` 서버 네트워크에 제출한다.

### DNS Resolver

`DNS` 확인자 또는 재귀 확인자는 컴퓨터와 다른 `DNS` 서버 간의 기본 중재자 역할을 한다.

이는 요청을 다른 도메인 이름 시스템 서버로 전달한 다음 요청이 완료되면 다시 전송하는 것이다.

`DNS` 확인자가 요청을 받으면 먼저 캐시를 검색하여 도메인 이름과 일치하는 `IP` 주소를 찾는다.

`IP` 주소가 발견되면 `DNS` 서버로 전송된 요청이 여기에서 종료되고 방문하려는 사이트가 즉시 표현된다.

만약 캐시에서 일치하는 항목이 없으면 `DNS` 확인자는 요청을 다음 `DNS` 서버인 `Root DNS` 서버로 보낸다.

### Root Nameserver

`Root DNS` 서버는 `DNS` 계층 구조의 맨 위에 존재한다.

찾고자 하는 도메인 이름과 일치하는 `IP` 주소에 대한 정보를 보관하지 않지만 해당 정보를 가지고 있는 `DNS` 서버의 위치에 대한 정보를 제공한다.

`DNS` 확인자로 부터 요청을 받으면 `Top-Level-Domain` 즉 `TLD` 를 식별한다.

그리고 `TLD Nameserver` 로 이동하도록 지시한다.

### TLD Nameserver

**`TLD`** 를 사용하는 도메인 이름에 대한 정보를 저장하고 관리하는 `DNS` 서버 기능이다.

`TLD` 는 `.com`, `.org`, `.online` , `.net` 과 같은 도메인 이름의 맨 끝을 뜻한다.

`naver**.com**` 의 `IP` 주소를 찾는 것이라면 `Root DNS`서버는 `DNS` 확인자를 **`.com` 에 대한** `TLD Nameserver` 로 리디렉션한다.
다음으로 `TLD Nameserver`는 신뢰할 수 있는 특정 네임서버에서 일치하는 `IP` 주소의 위치에 대해 확인자에게 알린다.

### Authoritative Nameserver

권한 있는 `DNS` 서버는 `DNS` 확인 프로세스의 최종 권한이다.

`IP` 주소를 포함하여 방문하고자 하는 도메인 이름과 관련된 모든 정보를 저장한다.

`DNS` 확인자는 `IP` 주소를 가져와 컴퓨터로 다시 보내 사이트로 안내한다.

### DNS 동작과정

브라우저에 `www.naver.com` 을 입력했을 때 일어나는 과정에 대해 알아보자.

1. 컴퓨터는 먼저 브라우저의 캐시와, **IP 주소와 도메인 주소를 매핑해주는 파일인** `host` 파일을 검색한다.
   만약 `host` 파일에 우리가 입력해 놓은 서버의 이름과 `IP` 주소가 존재하면 `DNS` 에 질의를 하지 않고 바로 접속하게 된다.
   없으면 다음 단계로 진행한다.
2. 컴퓨터는 로컬 `DNS` 캐시를 확인한다.
   로컬 `DNS` 캐시는 최근에 방문한 도메인 이름과 해당 도메인 이름에 대한 `IP` 주소를 저장하는데, 이를 통해 빠른 접속을 가능하게 한다.
   만약 로컬 `DNS` 캐시에 해당 도메인 이름이 없다면, 다음 단계로 진행한다.
3. 로컬 `DNS`는 루트 `DNS` 서버에게 도메인 이름에 대한 `IP` 주소를 아는지에 대해 질의한다.
4. 루트 `DNS` 서버는 로컬 `DNS`에게 `.com`을 관리하는 `TLD(Top-Level Domain) DNS`서버의 정보를 포함하여 응답한다.
5. 로컬 `DNS` 는 서버는 `.com` 을 관리하는 `DNS` 에게 요청한다.
6. `.com` 을 관리하는 `DNS` 또한 해당 정보가 없기 때문에 `naver.com` 도메인을 관리하는 `DNS` 서버 (`sub domain`) 의 정보를 포함하여 응답한다.
   가비아 또는 `Amazon Route 53` 가 이제 `sub Domain` 을 관리하는 `DNS` 서버가 되는 것이다.
7. 로컬 `DNS` 서버는 이제 `naver.com` 도메인을 관리하는 `DNS` 서버로 부터 `IP` 주소를 질의한다.
8. 이제 이 `DNS` 서버는 `naver.com` 도메인을 직접 관리하고 있으므로 해당 `IP` 주소를 반환한다.
9. 로컬 `DNS` 는 `IP` 주소를 캐시에 저장하고, 브라우저에게 `IP` 주소를 반환한다.
10. 브라우저는 반환받은 `IP` 주소를 사용하여 해당 도메인 이름에 접속한다.

### 느낀점

우리의 눈에는 단순히 주소를 입력해서 해당 사이트에 방문한다라는 기본적인 생각만 가지고 있는데 각각의 절차에서 누가 무엇을 담당하는지 알 수 있었다.

인프라관련 개발에 대한 경험은 없지만 이러한 기본적인 동작과정에 대해 알고있다면 추후에 도움이 될 것이라 생각한다.
